"use strict";(self.webpackChunkrspress_doc_template=self.webpackChunkrspress_doc_template||[]).push([["448"],{7391:function(e,n,s){s.r(n),s.d(n,{default:function(){return t}});var r=s(5893),i=s(65);function a(e){let n=Object.assign({h1:"h1",a:"a",p:"p",h2:"h2",pre:"pre",code:"code",h3:"h3",ul:"ul",li:"li",div:"div"},(0,i.ah)(),e.components);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.h1,{id:"-ngnix",children:["\uD83C\uDF10 Ngnix",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#-ngnix",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"Nginx \u662F\u4E00\u4E2A\u9AD8\u6027\u80FD\u7684Web\u670D\u52A1\u548C\u53CD\u5411\u4EE3\u7406\u670D\u52A1\uFF0C\u5B83\u7684\u7279\u6027\u662F\u9AD8\u5E76\u53D1\u3001\u5185\u5B58\u5360\u7528\u5C11\u3001\u914D\u7F6E\u7B80\u5355\u7B49\u7B49\u3002"}),"\n",(0,r.jsxs)(n.h2,{id:"\u5B89\u88C5",children:["\u5B89\u88C5",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u5B89\u88C5",children:"#"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"yum install nginx\n"})}),"\n",(0,r.jsxs)(n.h2,{id:"\u5E38\u7528\u547D\u4EE4",children:["\u5E38\u7528\u547D\u4EE4",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u5E38\u7528\u547D\u4EE4",children:"#"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",meta:'title="\u542F\u52A8"',children:"systemctl start nginx\n#nginx\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",meta:'title="\u505C\u6B62"',children:"systemctl stop nginx\n#nginx -s stop\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",meta:'title="\u91CD\u542F"',children:"systemctl restart nginx\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",meta:'title="\u91CD\u8F7D"',children:"systemctl reload nginx\n#nginx -s reload\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",meta:'title="\u6D4B\u8BD5\u914D\u7F6E"',children:"nginx -t\nnginx -T\n# \u5927 T \u4F1A\u5217\u51FA\u6240\u6709\u914D\u7F6E\u4FE1\u606F\uFF0C\u5305\u62EC include \u7684\u914D\u7F6E\u6587\u4EF6\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",meta:'title="\u67E5\u770B\u72B6\u6001"',children:"systemctl status nginx\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",meta:'title="\u67E5\u770B\u8FDB\u7A0B\u72B6\u6001"',children:"ps aux|grep nginx\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",meta:'title="\u67E5\u770B\u7248\u672C"',children:"nginx -v\nnginx -V\n# \u5927 V \u4F1A\u5217\u51FA\u6240\u6709\u914D\u7F6E\u4FE1\u606F\uFF0C\u5305\u62EC\u7F16\u8BD1\u53C2\u6570\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",meta:'title="\u67E5\u770B\u5E2E\u52A9"',children:"nginx -h\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",meta:'title="\u67E5\u770B\u65E5\u5FD7"',children:"tail -f /var/log/nginx/error.log\ntail -f /var/log/nginx/access.log\n"})}),"\n",(0,r.jsxs)(n.h2,{id:"\u914D\u7F6E",children:["\u914D\u7F6E",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u914D\u7F6E",children:"#"})]}),"\n",(0,r.jsxs)(n.h3,{id:"\u642D\u5EFA\u7F51\u7AD9",children:["\u642D\u5EFA\u7F51\u7AD9",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u642D\u5EFA\u7F51\u7AD9",children:"#"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u914D\u7F6E\u7F51\u7AD9"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-nginx",meta:'title="/etc/nginx/conf.d/ssl.byteszero.cn.conf"',children:"server {\n    # BytesZero \u535A\u5BA2\u7F51\u7AD9\n    location / {\n        root /root/pro/blog/site/;\n        index index.html;\n    }\n}\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u89E3\u51B3 403 \u95EE\u9898"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",meta:'title="etc/nginx/nginx.conf"',children:"# \u67E5\u770B worker \u8FDB\u7A0B\u7528\u6237\nps aux|grep nginx\n# \u4FEE\u6539 nginx.conf \u4E2D\u7684 user\nuser root;\n# \u4FEE\u6539\u7F51\u7AD9\u76EE\u5F55\u6743\u9650\nchown -R root:root /root/pro/blog/site/\n# \u91CD\u542F\u670D\u52A1\nsystemctl restart nginx\n# \u3010\u2757\uFE0F\u3011\u9A8C\u8BC1\u4E00\u4E0B worker \u8FDB\u7A0B\u7528\u6237\nps aux|grep nginx\n"})}),"\n",(0,r.jsxs)(n.h3,{id:"\u914D\u7F6E\u8BC1\u4E66",children:["\u914D\u7F6E\u8BC1\u4E66",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u914D\u7F6E\u8BC1\u4E66",children:"#"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u7F51\u7AD9\u8BC1\u4E66\u914D\u7F6E"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-nginx",meta:'title="/etc/nginx/conf.d/ssl.byteszero.cn.conf"',children:"server {\n    ## \u5FC5\u9009SSL\u914D\u7F6E\n    listen 443 ssl; # \u5F00\u542F443\u7AEF\u53E3\u76D1\u542C\n    server_name ssl.byteszero.cn; # \u88AB\u76D1\u542C\u7684\u57DF\u540D\n    ssl_certificate /etc/nginx/cert/ssl.byteszero.cn.pem; # \u8BC1\u4E66\u6587\u4EF6\u8DEF\u5F84\n    ssl_certificate_key /etc/nginx/cert/ssl.byteszero.cn.key; # \u79C1\u94A5\u6587\u4EF6\u8DEF\u5F84\n}\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"http \u81EA\u52A8\u91CD\u5B9A\u5411\u5230 https"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-nginx",meta:'title="/etc/nginx/nginx.conf"',children:"server {\n    listen       80;\n    listen       [::]:80;\n    # HTTP\u5230HTTPS\u7684\u91CD\u5B9A\u5411\n    return 301 https://$host$request_uri;\n}\n"})}),"\n",(0,r.jsxs)(n.h3,{id:"\u53CD\u5411\u4EE3\u7406",children:["\u53CD\u5411\u4EE3\u7406",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u53CD\u5411\u4EE3\u7406",children:"#"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-nginx",meta:'title="/etc/nginx/conf.d/ssl.byteszero.cn.conf"',children:"# api \u63A5\u53E3\u4EE3\u7406\nserver {\n    location /api/ {\n        # \u4E3A\u4E86\u53BB\u6389 /api \u524D\u7F00\n        rewrite ^/api(/.*)$ $1 break; \n        # \u4EE3\u7406\u5230\u672C\u5730 8081 \u7AEF\u53E3\u670D\u52A1\u4E0A\n        proxy_pass http://localhost:8081;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n    }\n}\n"})}),"\n",(0,r.jsxs)(n.h3,{id:"\u8D1F\u8F7D\u5747\u8861",children:["\u8D1F\u8F7D\u5747\u8861",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u8D1F\u8F7D\u5747\u8861",children:"#"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-nginx",meta:'title="/etc/nginx/conf.d/ssl.byteszero.cn.conf"',children:"upstream backend_servers {\n    server backend_server1 weight=3;\n    server backend_server2 weight=2;\n    server backend_server3;\n    # \u6DFB\u52A0\u66F4\u591A\u7684\u540E\u7AEF\u670D\u52A1\u5668\u5E76\u8BBE\u7F6E\u6743\u91CD\n}\n\nserver {\n    location / {\n        proxy_pass http://backend_servers;\n    }\n}\n"})}),"\n",(0,r.jsxs)(n.h3,{id:"\u5176\u4ED6\u914D\u7F6E",children:["\u5176\u4ED6\u914D\u7F6E",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u5176\u4ED6\u914D\u7F6E",children:"#"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u914D\u7F6E Worker \u6570\u91CF"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-nginx",meta:'title="/etc/nginx/nginx.conf"',children:"worker_processes 4;\n# \u4E00\u822C\u8BBE\u7F6E CPU \u6838\u6570\u7684 1\uFF5E4 \u500D\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u914D\u7F6E Worker \u8FDE\u63A5\u6570"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-nginx",meta:'title="/etc/nginx/nginx.conf"',children:"events {\n    worker_connections 1024;\n}\n# \u4E00\u822C\u8BBE\u7F6E\u4E3A 1024\uFF0C\u53EF\u901A\u8FC7\u5982\u4E0B\u547D\u4EE4\u67E5\u770B\u6BCF\u4E2A CPU \u6838\u5FC3\u80FD\u5904\u7406\u7684\u6700\u5927\u8FDE\u63A5\u6570\uFF0C\u8BBE\u5B9A\u5373\u53EF\ncat /proc/sys/net/core/somaxconn\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u67E5\u770B\u670D\u52A1\u72B6\u6001"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"systemctl status nginx\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"\u25CF nginx.service - The nginx HTTP and reverse proxy server\n   Loaded: loaded (/usr/lib/systemd/system/nginx.service; enabled; vendor preset: enabled)\n   Active: active (running) since Sun 2023-12-17 16:00:22 CST; 16min ago\n  Process: 964949 ExecReload=/bin/kill -s HUP $MAINPID (code=exited, status=0/SUCCESS)\n  Process: 965138 ExecStart=/usr/sbin/nginx (code=exited, status=0/SUCCESS)\n  Process: 965136 ExecStartPre=/usr/sbin/nginx -t (code=exited, status=0/SUCCESS)\n  Process: 965134 ExecStartPre=/usr/bin/rm -f /run/nginx.pid (code=exited, status=0/SUCCESS)\n Main PID: 965139 (nginx)\n    Tasks: 5 (limit: 11849)\n   Memory: 3.1M\n   CGroup: /system.slice/nginx.service\n           \u251C\u2500965139 nginx: master process /usr/sbin/nginx\n           \u251C\u2500965140 nginx: worker process\n           \u251C\u2500965141 nginx: worker process\n           \u251C\u2500965142 nginx: worker process\n           \u2514\u2500965143 nginx: worker process\n"})}),"\n",(0,r.jsxs)(n.div,{className:"rspress-directive tip",children:[(0,r.jsx)(n.div,{className:"rspress-directive-title",children:"\u5982\u4E0A\u53EF\u4EE5\u770B\u51FA"}),(0,r.jsxs)(n.div,{className:"rspress-directive-content",children:["\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u670D\u52A1\u5DF2\u7ECF\u542F\u52A8"}),"\n",(0,r.jsx)(n.li,{children:"\u8FD0\u884C\u4E86 16 \u5206\u949F"}),"\n",(0,r.jsx)(n.li,{children:"\u4E3B\u8FDB\u7A0B ID \u4E3A 965139"}),"\n",(0,r.jsx)(n.li,{children:"\u5DE5\u4F5C\u8FDB\u7A0B\u6570\u4E3A 5"}),"\n",(0,r.jsx)(n.li,{children:"\u5185\u5B58\u5360\u7528 3.1M"}),"\n",(0,r.jsx)(n.li,{children:"1 master \u8FDB\u7A0B"}),"\n",(0,r.jsx)(n.li,{children:"4 \u4E2A worker \u8FDB\u7A0B"}),"\n"]}),"\n"]})]})]})}function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,i.ah)(),e.components);return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}let t=c;c.__RSPRESS_PAGE_META={},c.__RSPRESS_PAGE_META["blog%2Fsdk%2Fnginx.mdx"]={toc:[{text:"\u5B89\u88C5",id:"\u5B89\u88C5",depth:2},{text:"\u5E38\u7528\u547D\u4EE4",id:"\u5E38\u7528\u547D\u4EE4",depth:2},{text:"\u914D\u7F6E",id:"\u914D\u7F6E",depth:2},{text:"\u642D\u5EFA\u7F51\u7AD9",id:"\u642D\u5EFA\u7F51\u7AD9",depth:3},{text:"\u914D\u7F6E\u8BC1\u4E66",id:"\u914D\u7F6E\u8BC1\u4E66",depth:3},{text:"\u53CD\u5411\u4EE3\u7406",id:"\u53CD\u5411\u4EE3\u7406",depth:3},{text:"\u8D1F\u8F7D\u5747\u8861",id:"\u8D1F\u8F7D\u5747\u8861",depth:3},{text:"\u5176\u4ED6\u914D\u7F6E",id:"\u5176\u4ED6\u914D\u7F6E",depth:3}],title:"\uD83C\uDF10 Ngnix",frontmatter:{}}}}]);